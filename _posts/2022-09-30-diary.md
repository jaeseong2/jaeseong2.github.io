---
title: 2022.09.30 기록
date: 2022-09-30 23:14:00 +0900
categories: [Diary]
tags: []
---

### 회사

오늘은 인사배치 강화학습에 들어가는 제약조건에 대해 같이 정리해보고 논의하려 했었으나 급하게 서버 장애가 생기는 바람에 다른 거의 하지 못했다.

AWS에 EC2 Spot으로 올려둔 메인으로 쓰는 RabbitMQ가 있다. 메인을 Spot으로 올려뒀다고 하니 뭔가 좀 이상해보이긴 한데, 거의 2~3년간 쓰면서 이런 일이 일어난 건 처음인 것 같다. spot으로 올려둔 인스턴스의 price를 on-demand 로 설정해둬서 사실 on-demand와 동일하게 쓸 수 있다고 생각했었는데 꼭 그런건 아닌가 보다. 아니면 on-demand price가 올라간건가? 아깐 이유를 몰랐는데 지금 쓰면서 생각해보니까 그럴 것 같기도 하다. 음.. 나중에 확인해봐야겠다.

그 서버가 내려갔다 올라가면서 private과 public ip가 동시에 모두 바뀌었고, 기존의 ip로 환경변수를 가지고 돌고 있던 워커들은 모두 커넥션 에러가 났다. 다행히 센트리덕에 에러를 빨리 발견해서 시크릿을 변경하고 재배포를 해주었지만 이때까지는 내가 private ip만 변경된 줄 알았다. public ip는 eip로 묶어둬서 안 변한다는 기억이 있어서 볼 생각도 못했다. public ip도 쓰는 이유는 ibk와 직접 커넥션을 하는 서버는 네이버 공공기관 클라우드에 올라가 있기 때문이다. 

그렇게 해결했다고 생각하고 있을 때, 또 다시 에러가 슬랙에 찍혔고 그걸 보고 public도 변경된 것을 알았다. 여기서부터는 조금 해야할 작업들이 늘어난다. ibk말고도 다른 여러 은행사가 있는데, 거기 서버들에도 모두 접속해서 환경변수를 수정해줘야한다. 금융기관 클라우드 특성상 접근이 쉽지 않은 서버들도 조금 있다. 그리 늦지 않게? 모두 변경했다.

이 이슈외에도 프로덕션 예측 워커에 새로운 버전을 적용했다가 아직 구버전을 사용하고 있는 다른 서버와 싱크가 맞지 않는 바람에 진땀을 빼기도 했다. 어찌저찌 무사히 해결을 했고 그제서야 원래 하려했던 제약조건 정리를 했다.

늘 느끼는 거지만 저런 긴급 상황에서 태스크를 놓치지 않고 병렬로 하는 능력은 중요하지만 힘든 일인 것 같다. 

### 블로그

블로그를 처음 만들어야겠다고 생각했을 때부터 하루를 정리하며 되돌아보는 시간을 가질 수 있도록 일기를 적으려 했다. 근데 어제처럼 새 포스트를 올리거나 프로젝트로 바쁜 날에는 스킵하는게 좋을 것 같다. 하루를 돌아보는 것도 좋지만 집중이 잘 될 때는 그 일을 계속하는게 맞는 것 같다.

원래 그래서 오늘은 사실 강화학습 두번째 강의를 듣고 그 정리 포스트나 어제 봤던 강화학습 개념 영상들을 정리하는 포스트를 올릴려 했었는데, 어제 올린 강화학습 강의 정리 포스트를 수정하다보니 시간이 너무 많이 지났다. 물론, 복습을 하면서도 시간을 썼지만 오랜만에 LaTeX 문법을 사용하려니 기억이 안나는 것들이 꽤 있어서 그거 찾느라 시간을 많이 썼다. 그리고 여기 수식 표현에 사용되는 라이브러리는 javascript의 MathJax인데, LaTeX와는 조금 다른 것 같아 거기서도 조금 헤맸다. (사실 drx rng 경기를 보고 해야지 했다가 롤이 재밌어 보여서 몇 판한게 제일 큰 것 같다.)

그래서 오늘 안으로 어떤 정리 포스트든 쓰지 못할 것 같아 일기를 썼다. 쓰고 보니 꽤 바빴던 하루였다.
